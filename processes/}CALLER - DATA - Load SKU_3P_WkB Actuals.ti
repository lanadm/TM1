#region Prolog

#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Set Variables
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

strCube_g = 'SKU_3P_Wkb';
strWeekCube_g = 't-weeks';
strView = 'zz_'| strCube_g | '_ZeroOut';
strSub = strView;
numLoadWeeks = 5;

#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Trim the parameters to eliminate leading or trailing blanks
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

strYear_g = TRIM(pYear);
strStartWeek_g = TRIM(pStartWeek);
strEndWeek_g = TRIM(pEndWeek);

#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Set Process Variables
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

strZeroOutProcess = '}SKU_3P_WkB - Zero Weekly Data for Load';
strCMS3Process = '}SKU_3P_WkB - Load Actual Data';
strCMS4Process = '}SKU_3P_WkB - Load Actual Data - Transactions';

#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Set Dimension Variables
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

strYearDim = 'YEAR';
strLocationsDim = 'LOCATIONS';
strSkusDim = 'Lskus';
strWeekDim = 'WEEK';
strStatDim = 'Lstat';
strChannelDim = 'Lchannel';

#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Set the information variables including directories and names to use for logging and errors
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

strProcessName = GETPROCESSNAME();
#strErrorFile = strProcessName | '_' | TIMST(NOW, '\Y\m\d') | '.csv';
#strLogDirectory = CELLGETS('bpmControl','Log Directory','Value');
#strLogDirectory = strLogDirectory | IF(SUBST(strLogDirectory, LONG(strLogDirectory), 1) @= '\', '', '\');
#strError = strLogDirectory | strErrorFile;
#numErrorCount = 0;

#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Check if Year, Start Week, End Week, and Start Week are blank. If not, then set the variables based on the input.
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

IF(strYear_g @<> '' & strStartWeek_g @<> '' & strEndWeek_g @<> '' );
    strChoreLoad = 'F';
    numStartWeek = NUMBR(strStartWeek_g);
    numEndWeek = NUMBR(strEndWeek_g);
    numLoadWeeks = NUMBR(strEndWeek_g) - NUMBR(strStartWeek_g) + 1;
ENDIF;

#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# If the Year, Start Week or End Week parameter is blank, but none of the above apply, go out and grab the info from the bpmControl Cube
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

IF(strYear_g @= '');
    strYear_g = CELLGETS('bpmControl','SKU_DATA Load - Fiscal Year','Value');
ENDIF;

IF(strStartWeek_g @= '');
    strStartWeek_g = CELLGETS('bpmControl','SKU_DATA Load - Start Week','Value');
    numStartWeek = NUMBR(strStartWeek_g);
ENDIF;

IF(strEndWeek_g @= '');
    strEndWeek_g = CELLGETS('bpmControl','SKU_DATA Load - End Week','Value');
    numEndWeek = NUMBR(strEndWeek_g);
ENDIF;


#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Execute Processes
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


EXECUTEPROCESS(strZeroOutProcess, 'pYear', strYear_g, 'pStartWeek', strStartWeek_g,'pEndWeek',strEndWeek_g);
EXECUTEPROCESS(strCMS3Process, 'pStartWeek', strYear_g | strStartWeek_g, 'pEndWeek', strYear_g | strEndWeek_g);
EXECUTEPROCESS(strCMS4Process, 'pStartWeek', strYear_g | strStartWeek_g, 'pEndWeek', strYear_g | strEndWeek_g);




#endregion