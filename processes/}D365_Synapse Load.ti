#region Data

Category = 'Actual';

#----------------------------------------------------------------------------
# Reverse signs on accounts marked as "NEG"
#----------------------------------------------------------------------------

AcctType = attrs( 'D365_MainAcct', MainAcct, 'PosNeg' );
AcctSign = if( AcctType @= 'Pos', 1, -1 );
DataSign = data * AcctSign;

#----------------------------------------------------------------------------
# For account 3205 if Product and Project are blank, assign to 00 and 000 respectively
#----------------------------------------------------------------------------

strProject = if( MainAcct @= '3205' & Project @= '', '000', Project );
strProduct = if( MainAcct @= '3205' & Product @= '', '00', Product );

#----------------------------------------------------------------------------
# Skip Test store and period 0
#----------------------------------------------------------------------------

If( trim( Location ) @= '52112022' );
    ITEMSKIP;
endif;

#----------------------------------------------------------------------------
# Load Data
#----------------------------------------------------------------------------

CellPutN( DataSign, 'D365_GL', FiscalYear, FiscalPeriod, Category, strProject, strProduct, Location, MainAcct );


#endregion